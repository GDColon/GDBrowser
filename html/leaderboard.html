<head>
	<title>Leaderboard</title>
	<meta charset="utf-8">
	<link href="../css/browser.css" type="text/css" rel="stylesheet">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-135255146-3"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-135255146-3');</script>
	<link rel="icon" href="../assets/trophy.png">
	<meta id="meta-title" property="og:title" content="Leaderboards">
	<meta id="meta-desc" property="og:description" content="View Geometry Dash's leaderboards, plus an accurate and updated list of the top 100 players.">
	<meta id="meta-image" name="og:image" itemprop="image" content="https://gdbrowser.com/assets/trophy.png">
</head>

<body class="levelBG" onbeforeunload="saveUrl()">

<div id="everything" style="overflow: auto;">

	<div class="popup" id="infoDiv">
		<div class="fancybox bounce center supercenter">
			<h2 class="smaller center" style="font-size: 5.5vmin">Leaderboard Info</h2>
			<p class="bigger center" id="infoText" style="line-height: 5vmin; margin-top: 1.5vmin"></p>
			<img src="../assets/ok.png" style="height: 6vmin" class="gdButton center" onclick="$('.popup').hide()">
		</div>
	</div>

	<div style="position:absolute; bottom: 0%; left: 0%; width: 100%">
		<img class="cornerPiece" src="../assets/corner.png" width=7%;>
	</div>

	<div style="position:absolute; bottom: 0%; right: 0%; width: 100%; text-align: right;">
		<img class="cornerPiece" src="../assets/corner.png" width=7%; style="transform: scaleX(-1)">
	</div>

	<div id="searchBox" class="supercenter dragscroll" style="width: 80vw; height: 75vh;"></div>
  <div>
    <div id="scoreTabs" class="flex spaceBetween">
      <img src="../assets/tab-top-on.png" class="leaderboardTab" id="topTabOn" style="display: none; height: 8vmin;">
      <img src="../assets/tab-top-off.png" class="leaderboardTab leaderboardClick" id="topTabOff" style="height: 8vmin;">
  
      <img src="../assets/tab-accurate-on.png" class="leaderboardTab" id="accurateTabOn" style="height: 8vmin;">
      <img src="../assets/tab-accurate-off.png" class="leaderboardTab leaderboardClick" id="accurateTabOff" style="display: none; height: 8vmin;">
  
      <img src="../assets/tab-creators-on.png" class="leaderboardTab" id="creatorTabOn" style="display: none; height: 8vmin;">
      <img src="../assets/tab-creators-off.png" class="leaderboardTab leaderboardClick" id="creatorTabOff" style="height: 8vmin;">
    </div>
    <div class="leaderboardBox supercenter gs" style="width: 83vw; height: 80vh; pointer-events: none"></div>
  </div>

	<div style="position:absolute; top: 2%; left: 1.5%; width: 10%; height: 25%; pointer-events: none">
		<img class="gdButton yesClick" id="backButton" src="../assets/back.png" height="30%" onclick="backButton()">
	</div>

	<div style="position:absolute; top: 2.5%; right: 2%; width: 10%; text-align: right;">
		<img class="gdButton" src="../assets/smallinfo.png" width="32%" onclick="$('#infoDiv').show()">
	</div>

	<div class="supercenter" id="loading" style="height: 10%; top: 47%; display: none;">
		<img class="spin noSelect" src="../assets/loading.png" height="105%">
	</div>

</div>

</body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.9/jquery.lazy.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.9/jquery.lazy.plugins.min.js"></script>
<script async type="text/javascript" src="../assets/sizecheck.js"></script>
<script type="text/javascript" src="../assets/dragscroll.js"></script>
<script>

let loading = false;

let top250Text = 
`The <g>Top 250<> leaderboard contains the <g>top 250 players<>, sorted by <y>star<> value. However, due to <o>hackers<> flooding the leaderboard, this leaderboard has been <b>frozen<> for well over 2 years and displays <o>very outdated information<>.`

let accurateText =
`The <g>Accurate Leaderboard<> is a highly accurate, hacker-proof leaderboard with <y>proper stats and positioning<> (unlike the regular one). It is managed by <b>SMJSGaming, XShadowWizardX, Pepper360, Octeract<>, and many many other helpers. You can check out their interactive <a target="_blank" href="https://docs.google.com/spreadsheets/d/10lbPnDYJXhbtlA0ls0cGjjX_osFSG559IDrTbhgPHvc"><span style="color:aqua" style="text-decoration: underline">leaderboard spreadsheet here<></a>.`

let creatorText = 
`The <g>Creators Leaderboard<> is sorted by <g>creator points<>, rather than stars. A player's <g>creator points<> (CP) is calculated by counting their number of <y>star rated<> levels, plus an extra point for every level that has been <b>featured<>, plus an additional point for <o>epic rated<> levels.`

function infoText(text) {
	let tweaked = text
	.replace(/<g>/g, '<span style="color:#4CDA5B">')
	.replace(/<b>/g, '<span style="color:#60ABEF">')
	.replace(/<y>/g, '<span style="color:yellow">')
	.replace(/<o>/g, '<span style="color:orange">')
	.replace(/<>/g, '</span>')
	$('#infoText').html(tweaked)
}

infoText(accurateText)


function leaderboard() {

	if (loading == true) return;

	$('#searchBox').html(`<div style="height: 4.5%"></div>`)
	loading = true;
	$('#loading').show()

	fetch(`../api/leaderboard?count=250&${type}`).then(res => res.json()).then(res => {

		res.forEach((x, y) => {

		$('#searchBox').append(`<div class="searchresult leaderboardSlot" style="justify-content: flex-start;">
      <div class="flex vertical spaceAround" style="height: 100%; margin-left: 6vmin">
        <img class="spaced lazyLoad" data-src="./icon/${x.username}" style="height: 10vmin;">
				<h2 class="small">${x.rank}</h2>
      </div>
      <div class="flex vertical spaceAround" style="width: 60vw; margin-left: 3vmin; margin-right: 6vmin">
        <div class="flex wrap" style="width: 100%;">
          <h2 class="small gdButton" style="margin-right: 2vmin;"><a href="../profile/${x.username}">${x.username}</a></h2>
          <div class="flex"><h3 style="width: 100%; font-size: 4vmin">${x.stars}</h3><img src="../assets/star.png" style="height: 3vmin; padding-bottom: 0.5vmin; cursor: help" title="Stars"></div>
        </div>
			  <h3 class="leaderboardStats flex wrap" style="width: 100%;">
          <div class="flex" style="padding-right: 1vmin;"><h3 style="width: 100%; font-size: 4vmin">${x.diamonds}</h3><img src="../assets/diamond.png" style="height: 4vmin; padding-top: 0.5vmin; padding-left: 1.2vmin; cursor: help" title="Diamonds"></div>
          <div class="flex" style="padding-right: 1vmin;"><h3 style="width: 100%; font-size: 4vmin">${x.coins}</h3><img src="../assets/coin.png" style="height: 4vmin; padding-top: 0.5vmin; padding-left: 1.2vmin; cursor: help" title="Secret Coins"></div>
          <div class="flex" style="padding-right: 1vmin;"><h3 style="width: 100%; font-size: 4vmin">${x.usercoins}</h3><img src="../assets/silvercoin.png" style="height: 4vmin; padding-top: 0.5vmin; padding-left: 1.2vmin; cursor: help" title="User Coins"></div>
          <div class="flex" style="padding-right: 1vmin;"><h3 style="width: 100%; font-size: 4vmin">${x.demons}</h3><img src="../assets/demon.png" style="height: 4vmin; padding-top: 0.5vmin; padding-left: 1.2vmin; cursor: help" title="Demons"></div>
				  ${x.cp != 0 ? `<div class="flex"><h3 style="width: 100%; font-size: 4vmin">${x.cp}</h3><img src="../assets/cp.png" style="height: 4vmin; padding-top: 0.5vmin; padding-left: 1.2vmin; cursor: help" title="Creator Points"></div>` : ""}
			  </h3>
      </div>
		</div>`)
		})

		$('#searchBox').append('<div style="height: 4.5%"></div>')
		loading = false;
		$('#loading').hide();
		$('.lazyLoad').Lazy({
			appendScroll: '#searchBox'
		});
	})

}

	let type = "accurate"
	leaderboard()

	$('#topTabOff').click(function() {
		if (type == "top" || loading) return;
		type = "top"
		leaderboard()
		$('.leaderboardTab').hide();
		$('#topTabOn').show()
		$('#accurateTabOff').show()
		$('#creatorTabOff').show()
		infoText(top250Text)
	})

	$('#accurateTabOff').click(function() {
		if (type == "accurate" || loading) return;
		type = "accurate"
		leaderboard()
		$('.leaderboardTab').hide();
		$('#topTabOff').show()
		$('#accurateTabOn').show()
		$('#creatorTabOff').show()
		infoText(accurateText)
	})

	$('#creatorTabOff').click(function() {
		if (type == "creator" || loading) return;
		type = "creator"
		leaderboard()
		$('.leaderboardTab').hide();
		$('#topTabOff').show()
		$('#accurateTabOff').show()
		$('#creatorTabOn').show()
		infoText(creatorText)
	});


</script>